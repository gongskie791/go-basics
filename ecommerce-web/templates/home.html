{{template "header" .}}

<h1>Products</h1>

{{if .Products}}
<div class="product-grid">
    {{range .Products}}
    <div class="product-card">
        <div class="product-info">
            <h3>{{.Name}}</h3>
            <p class="description">{{.Description}}</p>
            <p class="price">${{printf "%.2f" .Price}}</p>
            <p class="stock">In stock: {{.Stock}}</p>
        </div>

        {{if gt .Stock 0}}
        <form action="/cart/add" method="POST" class="add-to-cart-form">
            <input type="hidden" name="product_id" value="{{.ID}}">
            <div class="quantity-row">
                <label for="quantity-{{.ID}}">Qty:</label>
                <input type="number" id="quantity-{{.ID}}" name="quantity" value="1" min="1" max="{{.Stock}}">
            </div>
            <button type="submit" class="btn btn-primary">Add to Cart</button>
        </form>
        {{else}}
        <p class="out-of-stock">Out of Stock</p>
        {{end}}
    </div>
    {{end}}
</div>
{{else}}
<p>No products available. <a href="/products/new">Add one!</a></p>
{{end}}

{{template "footer" .}}